# プロジェクト構築手順書（Tauri）

作成日: 2026年1月31日
対象: Rust + Tauri によるLinux向けワイヤーフレーム作成アプリ
前提: Rust / Git / Node.js 開発環境は整備済み

---

## 1. プロジェクト作成

### 1.1 フロントエンド雛形作成（Vite + TypeScript）

```bash
# 例: プロジェクト名 wireframe-app
npm create vite@latest wireframe-app -- --template react-ts
cd wireframe-app
```

### 1.2 依存関係のインストール

```bash
npm install
```

---

## 2. Tauri 導入

### 2.1 Tauri CLI の追加

```bash
npm install -D @tauri-apps/cli
```

### 2.2 Tauri 初期化

```bash
npx tauri init
```

初期化時の推奨設定:
- App name: `Wireframe Studio`
- Window title: `Wireframe Studio`
- Frontend dev server: `http://localhost:5173`
- Frontend build: `npm run build`
- Frontend dist: `dist`

---

## 3. 主要ライブラリ（推奨）

### 3.1 フロントエンド
- UI
  - `react`
  - `react-dom`
- 状態管理
  - `zustand`（軽量） もしくは `redux toolkit`
- 描画
  - `konva` + `react-konva`（2Dキャンバス）
- ショートカット
  - `react-hotkeys-hook`

#### 追加インストール例
```bash
npm install zustand konva react-konva react-hotkeys-hook
```

### 3.2 Tauri API
```bash
npm install @tauri-apps/api
```

---

## 4. Rust 側の準備

### 4.1 Tauri依存確認
`src-tauri/Cargo.toml` に自動追加済み。

### 4.2 推奨クレート
- `serde` / `serde_json`（JSONシリアライズ）
- `thiserror`（エラー定義）
- `uuid`（ID生成）
- `chrono`（日時）

#### 追加例（Cargo.toml）
```toml
[dependencies]
serde = { version = "1", features = ["derive"] }
serde_json = "1"
thiserror = "1"
uuid = { version = "1", features = ["v4"] }
chrono = { version = "0.4", features = ["serde"] }
```

---

## 5. 開発起動

### 5.1 フロントエンド起動
```bash
cd wireframe-app/
npm run dev
```

### 5.2 Tauri起動（別ターミナル）
```bash
cd wireframe-app/src-tauri/
npx tauri dev
```

---

## 6. ビルド/配布

### 6.1 リリースビルド
```bash
npx tauri build
```

生成物は `src-tauri/target/release/bundle/` に出力。

### 6.2 AppImageを無効化する場合
AppImageの生成で失敗する場合は、`src-tauri/tauri.conf.json` の `bundle.targets` を `deb` / `rpm` のみにします。

```json
"bundle": {
  "active": true,
  "targets": ["deb", "rpm"],
  "icon": [
    "icons/32x32.png",
    "icons/128x128.png",
    "icons/128x128@2x.png",
    "icons/icon.icns",
    "icons/icon.ico"
  ]
}
```

- これにより **AppImageは生成されません**。
- Ubuntu系は `.deb`、Fedora系は `.rpm` のみ配布対象になります。

---

## 7. 初期フォルダ構成（参考）

```
wireframe-app/
├─ src/                # Frontend
├─ src-tauri/          # Backend (Rust)
├─ public/
├─ package.json
└─ tauri.conf.json
```

---

## 8. 補足
### 8.1 Ubuntu 24 の依存パッケージ導入（実行例）

```bash
sudo apt update
sudo apt install -y pkg-config libgdk-pixbuf-2.0-dev
sudo apt install -y libgtk-3-dev libwebkit2gtk-4.1-dev
```

- `sudo apt update`
  - パッケージ一覧を最新化
- `sudo apt install -y pkg-config libgdk-pixbuf-2.0-dev`
  - `pkg-config`: Rustのビルド時にシステムライブラリの場所を解決するために必要
  - `libgdk-pixbuf-2.0-dev`: 画像読み込み系のGTK依存（`gdk-pixbuf-sys`）をビルドするために必要
- `sudo apt install -y libgtk-3-dev libwebkit2gtk-4.1-dev`
  - `libgtk-3-dev`: TauriのGUI基盤（GTK）
  - `libwebkit2gtk-4.1-dev`: TauriのWebView基盤（WebKit2GTK）

### 8.2 補足
- Linux向け依存（WebKit2 / GTK）はTauri公式に従って導入
- 詳細は Tauri公式ドキュメントを参照
